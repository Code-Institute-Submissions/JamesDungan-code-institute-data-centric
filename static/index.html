<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Reciplease!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="../bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="../main.css" />
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand" href="index.html">Home</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="navbar-link" href="{{ url_for('new_recipe') }}">Add New Recipe</a>
                </li>
            </ul>
        </div>
    </nav>    

<h1> Welcome to Reciplease </h1>
<div class="container list-container">
   
</div>

<div class="container single-container">
   
</div>

<!-- <div class="container single-container">
   
</div> -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="../bootstrap/bootstrap.min.js"></script>
</body>
</html>


<script type="text/javascript">

   $( document ).ready(function(){
    console.log("DOM is ready")
        showList();
        
    });
    
        
        
  
    
   $(window).on('hashchange', function() { 
    
    });

function showList(){
    console.log("showing list")
    $.getJSON('/reciplease/api/v1.0/recipes', function(data){
        $('.single-container', '.list-container').html('');
        $.each( data, function( key, val ) {
            $('.list-container').append(`<div class='row'>
                <div class='col-sm-10'>
                    <img src='../img/IMAG0022.jpg' class='img-thumbnail list-image'>
                    <h4 >`+val.name+`</h4>
                    <p>`+val.summary+`</p>
                    <button recipe_id=`+val._id.$oid+` type='button' class='btn btn-success read' >Read More</button>
                </div>
                <div class='col-sm-2'>
                    <h4>Timing</h4>
                    <p><b>Prep: </b>`+val.prep_time+` minutes</p>
                    <p><b>Cook: </b>`+val.cook_time+` minutes</p>
                    <br>
                    <button  recipe_id=`+val._id.$oid+` type='button' class='btn btn-outline-warning btn-sm'>EDIT</button>
                    <button  recipe_id=`+val._id.$oid+` type='button' class='btn btn-outline-danger btn-sm'>DELETE</button>
                </div>
            </div>`);
        });
        $('.read').click(function(){
            let id = this.getAttribute('recipe_id');
            showSingle(id);
            //////////////////NEXT
        })
 
    });
    
}

function showSingle(id){
    $.getJSON('/reciplease/api/v1.0/recipe/'+id, function(data){
        $('.list-container').html('');
        $('.single-container').append(id);
        
    });
}

</script>



